---
import Base from '../../layouts/Base.astro';
import { loadPublishedContent } from '../../lib/state';
import type { ProjectedWiki } from '../../lib/state';

const wikis = loadPublishedContent('wiki') as ProjectedWiki[];
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
---
<Base
  title="Wiki"
  description="All wiki entries."
  breadcrumbs={[
    { label: 'Wiki', href: `${base}/wiki/` },
  ]}
>
  <section class="home-section">
    <h1>Wiki</h1>
    {wikis.length > 0 ? (
      <ul class="content-list">
        {wikis.map((w) => (
          <li>
            <a href={`${base}/wiki/${w.meta.slug}/`}>{w.meta.title}</a>
            <code class="eo-op"><span class="eo-name">DES</span>(<span class="eo-target">{w.content_id}</span>)</code>
            {w.meta.tags.length > 0 && (
              <span class="tags">
                {w.meta.tags.map((t: string) => <span class="tag">{t}</span>)}
              </span>
            )}
          </li>
        ))}
      </ul>
    ) : (
      <p class="empty-page">No wiki entries published yet.</p>
    )}
  </section>
</Base>
