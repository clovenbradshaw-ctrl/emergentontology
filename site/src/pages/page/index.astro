---
import Base from '../../layouts/Base.astro';
import { loadAllContent } from '../../lib/state';
import type { ProjectedPage } from '../../lib/state';

const pages = loadAllContent('page') as ProjectedPage[];
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
---
<Base
  title="Pages"
  description="All pages."
  breadcrumbs={[
    { label: 'Home', href: `${base}/` },
    { label: 'Pages', href: `${base}/page/` },
  ]}
>
  <section class="home-section">
    <h1>Pages</h1>
    {pages.length > 0 ? (
      <ul class="content-list">
        {pages.map((p) => (
          <li>
            <a href={`${base}/page/${p.meta.slug}/`}>{p.meta.title}</a>
            <code class="eo-op"><span class="eo-name">DES</span>(<span class="eo-target">{p.content_id}</span>)</code>
            {p.meta.tags.length > 0 && (
              <span class="tags">
                {p.meta.tags.map((t: string) => <span class="tag">{t}</span>)}
              </span>
            )}
          </li>
        ))}
      </ul>
    ) : (
      <p class="empty-page">No pages published yet.</p>
    )}
  </section>
</Base>
